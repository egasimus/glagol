(let [screen (./template/render (./template/main {}))
      keymap ./options/keymap]

  (.map (keys keymap) (fn [event]
    (screen.key (aget keymap event)
      (fn [c k] (./events/emit event [c k])))))
  (./events/on :exit (fn [] (process.exit)))
  (./events/on :refresh (fn [] (screen.realloc) (screen.render)))

  { :undo (fn [] (screen.destroy)) })
