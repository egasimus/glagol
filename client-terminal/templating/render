(fn render [parent el]
  (let [widget (aget ../templates/widgets el.widget)]
    (if (not widget) (throw (Error (str "unknown widget " el.widget))))
    (let [rendered (widget el.options el.content)]
      (if parent (parent.append rendered))
      (if el.children (el.children.map (render.bind nil rendered)))
      rendered)))
