(lambda (s)

  (var options  (object "oncontextmenu" (/emit "app.contextMenu")))
  (var elements (array))

  (.map (Object.keys s.session.devices) (lambda (id)
    (var device (get s.session.devices id))
    (elements.push ((get /modules device.type "template") device))))

  (return (/h ".session" options elements)))
