(let [state @client-state
      vdom  @lib-vdom

      main-loop
        (or container._vdom_main_loop_
          (let [main-loop (vdom.start @client-template state)]
            (set! container._vdom_main_loop_ main-loop)
            (container.replace-child main-loop.target container.first-child)
            main-loop))]

  (console.debug "\nindex" state)

  (vdom.insert-css (require "./style.styl"))

  (log main-loop)

  (main-loop.update state))
