#!/usr/bin/env etude
(let [modules { :jack      ./jack/api
                :library   ./library/api
                :sampler   ./sampler/api
                :sequencer ./sequencer/api
                :transport ./transport/api }

      server  (new (.-Server (require :ws)) { :port 1620 })]

  (log.as :hello "running with modules" (.join (keys modules) " "))

  (server.on :connection (fn [socket]
    (log.as :connection "")
    ((require :q-connection) socket modules))))
