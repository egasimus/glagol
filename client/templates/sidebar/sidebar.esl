(lambda (state)
  (var elements (array))
  (function add (val) (elements.push val))

  (add (../transport (object) state))
  (add (/h "a.sidebar-device-add" "+ add device"))
  (.for-each (Object.keys state.session) add-device-to-sidebar)

  (return (/h ".sidebar" elements))
  
  (function add-device-to-sidebar (type)
    (.for-each (Object.keys (get state.session type)) (lambda (id)
      (add (./device type (get state.session type id)))))))
