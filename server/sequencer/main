(let [

  index
    0

  transport
    (./transport/each (fn []
      (./step index)
      (set! index (if (< index 15) (+ index 1) 0))))

  keyboard
    (./keyboard (fn [c k]
      (cond
        (and k.ctrl (= k.name :c)) (process.exit)
                    (= k.name :t)  (./tap-tempo))))

] (-> (./jack/init) (.progress (fn [msg] (log.as :jack-init msg))) (.done))

  { :undo (fn []
      (transport.undo)
      (keyboard.undo)) })
