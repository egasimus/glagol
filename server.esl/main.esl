(lambda main (app)
  (var port 1620)
  (var server-http (./web/server port))
  (var server-ws (new (. (require "ws") Server) (object "server" server-http)))
  (function on-ws (socket)
    (console.log "ws connection")
    ((require "q-connection") socket ./api))
  (console.log "starting with modules:" ((. (Object.keys ./api) join) " ")))
