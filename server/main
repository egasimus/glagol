(let [modules { :library   ./library/api
                :sampler   ./sampler/api
                :sequencer ./sequencer/main }

      server  (new (.-Server (require :ws)) { :port 1620 })]

  (log.as :hello "running with modules" (.join (keys modules) " "))

  (server.on :connection (fn [socket]
    (log.as :connection)
    ((require :q-connection) socket modules))))
