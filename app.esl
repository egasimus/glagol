(lambda (options app)
  (= app (to-glagol app))
  (.for-each (Array.prototype.slice.call arguments 2) overlay)
  (function to-glagol (x)
    (return (?: (=== "string" (typeof x)) (./bundler/glagol x options) x)))
  (function overlay (x)
    (app.overlay (to-glagol x)))
  (function handler (req res)
    (./bundler/bundle app req res))
  (= handler.tracked app)
  (return handler))
