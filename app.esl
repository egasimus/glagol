(lambda (glagol-opts client-path common-path)

  ; create a server-side glagol instance to keep track of the client code
  ; make one for shared client/server code too, and overlay it on top
  (var client (./util/glagol client-path glagol-opts))
  (if common-path (client.bind (./util/glagol common-path glagol-opts)))

  (return (object
    "node"    client
    "handler" (lambda (req res) ($.util.bundle client req res)))))
