(let [Diff (require "deep-diff")]
  (fn mainloop [screen get-template get-data]
    (let [render   (fn [] (./render screen (./parse ((get-template) (get-data)))))
          rendered (render)]
      (set-interval (fn []
        (screen.remove rendered)
        (try (set! rendered (render)) (catch e (log e.message)))
        (screen.append rendered)
        (screen.render)) 1000)
      (screen.render))))
