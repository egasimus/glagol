  (fn mainloop [screen get-template get-data]
    (let [parse     (fn [] (./parse ((get-template) (get-data))))
          parsed    (parse)
          render    (fn [parsed] (./render screen parsed))
          rendered  (render parsed)
          refresh   nil]

      (set! refresh (fn refresh []
        (./change parsed (parse))
        (screen.render)
        (set-timeout refresh ../options/refresh-rate)))

      (refresh)))

      ;(screen.render))))
